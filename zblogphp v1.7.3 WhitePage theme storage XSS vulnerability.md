# Summary
A cross-site scripting (XSS) vulnerability in the Backend `Theme Management module` of Z-BlogPHP v1.7.3 allows attackers to execute arbitrary web scripts or HTML via a crafted payload.

There is a stored XSS vulnerability in the WhitePage theme configuration of zblogphp v1.7.3.

# Details
Select and enable this theme:
![image](https://github.com/user-attachments/assets/f63625a7-e271-4391-9c79-3a96ac7a44c5)

Audit the configuration code of this theme
`zb_users\theme\WhitePage\main.php`

A bunch of stored XSS vulnerabilities were discovered:
![image](https://github.com/user-attachments/assets/987da642-e945-4868-ad7a-d7be389f9f12)

The <?php echo(xxx) in the code does not perform any filtering on the content output by echo, and looking forward, we can also find that the user input of this part is controllable:
![image](https://github.com/user-attachments/assets/40fdcb82-757c-41ab-b9ac-6332a24e2975)

So we construct the corresponding payload according to the HTML format:
```html
";><ScRiPt>alert(7)</ScRiPt>
```

Next, we use burpsuite to intercept the HTTP request package saved by the normal configuration options, and then modify the value of the parameter to the payload we constructed:
![image](https://github.com/user-attachments/assets/8b58c8b9-747c-47d7-826f-9eca4c0f8e5b)

Then we visit the configuration interface `main.php` again, and we can find that the stored XSS is triggered:
![image](https://github.com/user-attachments/assets/5311d151-a440-42b5-9b3d-13ee4c902a7a)

At this point, the payload we constructed is spliced ​​on the website as follows:
![image](https://github.com/user-attachments/assets/bf32dc00-e6bb-4361-9c8d-f2b733c94edc)



# PoC
```html
";><ScRiPt>alert(7)</ScRiPt>
```
![image](https://github.com/user-attachments/assets/690f071d-6f4a-4c9a-93ea-f6b577867c6e)
![image](https://github.com/user-attachments/assets/79b0ad08-e09e-47a5-af0c-9a81d0f985ed)
![image](https://github.com/user-attachments/assets/8ce876e1-d1dd-4f1a-a2f6-48fd449f873c)
