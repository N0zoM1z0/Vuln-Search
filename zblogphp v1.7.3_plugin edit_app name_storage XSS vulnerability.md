# Summary
A cross-site scripting (XSS) vulnerability in the Backend `AppCentre` of Z-BlogPHP v1.7.3 allows attackers to execute arbitrary web scripts or HTML via a crafted payload.

There is a stored XSS vulnerability in the `/zb_users/plugin/AppCentre/plugin_edit.php` of zblogphp v1.7.3.

Unlike CVE-2018-9169, version 1.7.3 filters the `app_id` parameter, but the **`app_name`** parameter still has a vulnerability.

# Details
Source code can be downloaded from: https://github.com/zblogcn/zblogphp/releases/download/v1.7.3-3230/zblogphp.zip .

Audit the code in `/zb_users/plugin/AppCentre/plugin_edit.php`:
![image](https://github.com/user-attachments/assets/b3745085-0f1d-4f29-a948-7725047a20ad)

Obviously, the app_id and app_name parameters seem controllable.

Although there is a regular filter for the app_id parameter:
![image](https://github.com/user-attachments/assets/cb700894-4ae5-43c5-84a6-65e0f3650a16)

However, there is no filtering for app_name, which is completely controllable by the user.

So we can carefully construct such a payload:
```html
";><ScRiPt>alert(7)</ScRiPt>
```

The specific process corresponding to the website is as follows:
![image](https://github.com/user-attachments/assets/e33cece9-79d9-4cf2-8f2e-3ec62a8c6644)
![image](https://github.com/user-attachments/assets/faf5f8f6-5a28-4392-8a9f-58421d77227f)

Then save the plugin and enable it:
![image](https://github.com/user-attachments/assets/a74fb562-39e3-4090-9bd8-4e58643027b4)
![image](https://github.com/user-attachments/assets/3a29283a-3314-4d14-8da1-ce9e2a270c0d)

Now visit `/zb_users/plugin/12_123/main.php`, the storage XSS will be triggerd:
![image](https://github.com/user-attachments/assets/fdc1bd23-a967-4454-8b23-7c1e065ae4b7)
![image](https://github.com/user-attachments/assets/3a9fba2b-3682-4762-a5f0-095b4fa3269e)



# PoC
```html
";><ScRiPt>alert(7)</ScRiPt>
```
![image](https://github.com/user-attachments/assets/faf5f8f6-5a28-4392-8a9f-58421d77227f)

![image](https://github.com/user-attachments/assets/fdc1bd23-a967-4454-8b23-7c1e065ae4b7)
![image](https://github.com/user-attachments/assets/3a9fba2b-3682-4762-a5f0-095b4fa3269e)
